## 2024-05-23 - ChatBubble Rebuild Optimization
**Learning:** `ValueListenableBuilder` at the top of a large, complex widget (like `ChatBubble` with `MarkdownBody`) causes expensive rebuilds of the entire subtree whenever the listenable notifies, even if only a tiny part (like a star icon) changes.
**Action:** Push the `ValueListenableBuilder` down to the smallest possible scope (e.g., just the icon row) and extract expensive static content (Markdown, Images) to be built outside the builder. Also, use imperative reads (e.g., `ref.read().isMessageStarred()`) in event handlers (`onLongPress`) instead of relying on closure-captured values from the builder scope to break dependencies on the builder.
